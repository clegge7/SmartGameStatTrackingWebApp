@model SmartGameStatTrackingWebApp.Models.Team

@{
    ViewBag.Title = Model.Name;
}
<script type="text/javascript" src="~/Content/js/plugins/jquery/jquery-3.3.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="~/Content/css/table.css" />

<script type="text/javascript">
    var teamName = @Html.Raw(Json.Encode(Model.Name));
    $.ajax({
        type: 'POST',
        url: '/Players/GetTeamPlayers',
        datatype: 'json',
        data: {
            teamName: teamName
        },
        success: function (data) {
            for (i = 0; i < data.length; i++) {
                if (data[i].gamesPlayed != 0) {
                    $('.TeamPlayers tr:last').after('<tr><th>' + data[i].number + '<th><a href=\"/Players/Details/' + data[i].id + '\">' + data[i].name + '</a></th>' +
                        '<th>' + data[i].team + '</th>' + '<th>' + data[i].gamesPlayed + '</th>' +
                        '<th>' + (data[i].points / data[i].gamesPlayed).toFixed(1) + '</th><th>' + (data[i].rebounds / data[i].gamesPlayed).toFixed(1) + '</th>' +
                        '<th>' + (data[i].assists / data[i].gamesPlayed).toFixed(1) + '</th><th>' + (data[i].blocks / data[i].gamesPlayed).toFixed(1) + '</th>' +
                        '<th>' + (data[i].steals / data[i].gamesPlayed).toFixed(1) + '</th><th>' + (data[i].turnovers / data[i].gamesPlayed).toFixed(1) + '</th>' +
                        '<th>' + (data[i].personalFouls / data[i].gamesPlayed).toFixed(1) + '</th><th>' + (data[i].technicalFouls / data[i].gamesPlayed).toFixed(1) +
                        '</th><th>' + data[i].season + '</th></tr>');
                }
                else {
                    $('.TeamPlayers tr:last').after('<tr><th>' + data[i].number + '<th><a href=\"/Players/Details/' + data[i].id + '\">' + data[i].name + '</a></th>' +
                        '<th>' + data[i].team + '</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>' + data[i].season + '</th></tr>');
                }
            }
        }
    });

    $(document).ready(function () {
        $(".createPlayer").on('click', function () {
            $(".playerCreatePartial").css("display", "block");
            $("#team").val(teamName);
            $("#season").val(2018);
            $(this).hide();
        });
    });
</script>

<div>
    <dl class="dl-horizontal">

        <dt>
            @Html.DisplayNameFor(model => model.wins)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.wins)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.losses)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.losses)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.season)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.season)
        </dd>

        <p>
            @Html.ActionLink("Edit", "Edit", new { id = Model.ID }) |
            @Html.ActionLink("Back to List", "Index")
        </p>

    </dl>
</div>
<div style="overflow-x:scroll;">
    <table class="TeamPlayers table table-responsive">
        <tr class="head">
            <th>
                Number
            </th>
            <th>
                Player
            </th>
            <th>
                Team
            </th>
            <th>
                GP
            </th>
            <th>
                PPG
            </th>
            <th>
                RPG
            </th>
            <th>
                APG
            </th>
            <th>
                BPG
            </th>
            <th>
                SPG
            </th>
            <th>
                TOPG
            </th>
            <th>
                PFPG
            </th>
            <th>
                TFPG
            </th>
            <th>
                Season
            </th>
        </tr>
    </table>
</div>

<button type="button" class="createPlayer">Add Player</button>

<div class="playerCreatePartial" style="display:none;">
    @{
        @Html.Partial("~/Views/Partials/_PlayerCreate.cshtml", new SmartGameStatTrackingWebApp.Models.Player());
    }
</div>